<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Aptitude Test</title>

<!-- Bootstrap & Font Awesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    body { background-color: #f8f9fa; }
    .test-container { background: #fff; padding: 25px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-top: 30px; }
    .question h5 { font-weight: 600; }
    .btn-submit { margin-top: 20px; }
    .result { font-size: 1.2rem; font-weight: bold; margin-top: 20px; text-align: center; }
    .navbar-brand { font-weight: bold; font-size: 1.3rem; }
</style>
</head>

<body>

<!-- Navbar -->
<nav class="navbar navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="#"><i class="fas fa-graduation-cap me-2"></i>CareerConnect</a>
    <span class="navbar-text text-white">Aptitude Test</span>
  </div>
</nav>

<div class="container">
  <div class="test-container">
    <h2 class="mb-4 text-center">Aptitude Test</h2>

    <form id="aptitudeTest"></form>

    <div class="d-grid">
      <button type="button" class="btn btn-primary btn-submit" onclick="submitTest()">Submit Test</button>
    </div>

    <div id="result" class="result"></div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
window.onload = function() {
  const allQuestions = [
    {question: "The average of 20, 30 and 40 is?", options: ["25","30","35","40"], answer: "30"},
    {question: "Find the missing term: 3, 6, 12, 24, ?", options: ["36","48","60","72"], answer: "48"},
    {question: "A car travels 150 km in 3 hours. What is its speed?", options: ["30 km/h","40 km/h","50 km/h","60 km/h"], answer: "50 km/h"},
    {question: "Simplify: (15 × 4) ÷ 6", options: ["8","10","12","14"], answer: "10"},
    {question: "A shopkeeper buys an item for ₹200 and sells it for ₹250. Profit % ?", options: ["20%","22%","25%","30%"], answer: "25%"},
    {question: "What is 3/5 of 200?", options: ["80","100","120","140"], answer: "120"},
    {question: "Which of the following is NOT a prime number?", options: ["17","19","21","23"], answer: "21"},
    {question: "Solve for x: 3x – 7 = 11", options: ["5","6","7","8"], answer: "6"},
    {question: "Find the odd one out: 8, 27, 64, 100, 125", options: ["8","27","64","100"], answer: "100"},
    {question: "A clock shows 2:30. Angle between hour & minute hands?", options: ["75°","80°","90°","105°"], answer: "105°"},
    {question: "If a square has side 12 cm, what is its area?", options: ["124 cm²","144 cm²","164 cm²","120 cm²"], answer: "144 cm²"},
    {question: "If 6 workers build a wall in 12 days, how long will 8 workers take?", options: ["8 days","9 days","10 days","12 days"], answer: "9 days"},
    {question: "Probability of drawing a red card from a standard deck?", options: ["1/2","1/3","1/4","1/52"], answer: "1/2"},
    {question: "Next number in the series: 5, 10, 20, 40, ?", options: ["50","60","70","80"], answer: "80"},
    {question: "If the simple interest on ₹1000 at 5% per annum for 2 years is?", options: ["₹50","₹75","₹100","₹150"], answer: "₹100"}
  ];

  function shuffle(array) {
    let currentIndex = array.length, randomIndex;
    while (currentIndex !== 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
      [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
    }
    return array;
  }

  const questions = shuffle([...allQuestions]).slice(0, 10);
  const form = document.getElementById("aptitudeTest");

  questions.forEach((q, index) => {
    const div = document.createElement("div");
    div.classList.add("question", "mb-4");

    const qTitle = document.createElement("h5");
    qTitle.innerText = "Q" + (index + 1) + ". " + q.question;
    div.appendChild(qTitle);

    q.options.forEach(option => {
      const label = document.createElement("label");
      label.classList.add("form-check-label");

      const input = document.createElement("input");
      input.type = "radio";
      input.classList.add("form-check-input", "me-2");
      input.name = "question" + index;
      input.value = option;

      const optionDiv = document.createElement("div");
      optionDiv.classList.add("form-check");

      optionDiv.appendChild(input);
      optionDiv.appendChild(document.createTextNode(option));
      div.appendChild(optionDiv);
    });

    form.appendChild(div);
  });

  // Submit function with 70% pass logic
  window.submitTest = function() {
    let score = 0;
    let total = questions.length;
    let unanswered = 0;

    for (let i = 0; i < total; i++) {
        const selected = document.querySelector('input[name="question' + i + '"]:checked');
        if (!selected) { unanswered++; continue; }
        if (selected.value === questions[i].answer) { score++; }
    }

    const resultDiv = document.getElementById("result");

    if (unanswered > 0) {
        resultDiv.innerHTML = '<span class="text-danger">Please answer all questions. You left ' + unanswered + ' question(s) unanswered.</span>';
        return;
    }

    const percentage = ((score / total) * 100).toFixed(2);

    if (percentage >= 70) {
        resultDiv.innerHTML = '<span class="text-success">' +
            'Congratulations! You scored ' + score + ' out of ' + total + ' (' + percentage + '%).' +
            '<br>Proceeding to the next round...' +
            '</span>';
        setTimeout(() => { window.location.href = "/assessment"; }, 3000);
    } else {
        resultDiv.innerHTML = '<span class="text-danger">' +
            'You scored ' + score + ' out of ' + total + ' (' + percentage + '%).' +
            '<br>Sorry, you did not qualify for the next round.' +
            '</span>';
    }
  };
};
</script>

</body>
</html>